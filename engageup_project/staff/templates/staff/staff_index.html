{% extends 'staff/staff_base.html' %} 

{% block title %}ãƒ›ãƒ¼ãƒ  | EngageUp{% endblock %}

{% block content %}
<!-- 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚¨ãƒªã‚¢ -->
<div class="welcome-banner mb-4">
    <div class="d-flex align-items-center">
        <div class="avatar-wrapper">
            <!-- å°†æ¥çš„ã«ã¯ {{ user.profile_image.url }} -->
            <span class="user-icon">ğŸ±</span>
        </div>
        <div class="ms-3">
            <h2 class="greeting-text">
                ãŠç–²ã‚Œæ§˜ã§ã™ã€ã‚²ã‚¹ãƒˆã•ã‚“
                <!-- {% if user.is_authenticated %}{{ user.last_name }}{% else %}ã‚²ã‚¹ãƒˆ{% endif %}ã•ã‚“ï¼ -->
            </h2>
            <p class="status-msg">ç¾åœ¨ã®ãƒ©ãƒ³ã‚¯ï¼š<strong>ã‚·ãƒ«ãƒãƒ¼ä¼šå“¡</strong> <!-- å°†æ¥çš„ã« {{ user.rank }} --></p>
        </div>
    </div>
</div>

<!-- 2. å­¦ç¿’ã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ï¼ˆã‚¯ã‚¤ãƒƒã‚¯çµ±è¨ˆï¼‰ -->
<div class="row g-3 mb-4">
    <div class="col-6">
        <div class="stat-box">
            <p class="stat-label">å®Œäº†ã—ãŸæ¤œå®š</p>
            <p class="stat-value">24<small>ä»¶</small></p> <!-- {{ completed_count }} -->
        </div>
    </div>
    <div class="col-6">
        <div class="stat-box accent">
            <p class="stat-label">æ‰€æŒãƒãƒƒã‚¸</p>
            <p class="stat-value">12<small>å€‹</small></p> <!-- {{ badges_count }} -->
        </div>
    </div>
</div>

<!-- 3. ã€é‡è¦ã€‘ãƒãƒƒã‚¸å–å¾—ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼ˆãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸é™å®šï¼‰ -->
<div class="content-box ranking-section mb-4">
    <div class="box-header">
        <h2 class="page-title">ğŸ† ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ»ãƒ©ãƒ³ã‚­ãƒ³ã‚°</h2>
        <span class="update-time">1æ™‚é–“ã”ã¨ã«æ›´æ–°</span>
    </div>
    
    <div class="ranking-container">
        <!-- 1ä½ï¼ˆã‚‚ã£ã¨ã‚‚ç›®ç«‹ãŸã›ã‚‹ï¼‰ -->
        <div class="rank-card gold">
            <div class="rank-badge">1</div>
            <div class="user-img">ğŸ¥‡</div>
            <div class="rank-info">
                <span class="user-name">ç”°ä¸­ å¤ªéƒ</span> <!-- {{ top_rank.0.user.last_name }} -->
                <span class="score">32æšç²å¾—</span> <!-- {{ top_rank.0.badge_count }} -->
            </div>
        </div>

        <!-- 2ä½ãƒ»3ä½ï¼ˆæ¨ªä¸¦ã³ï¼‰ -->
        <div class="row g-2 mb-3">
            <div class="col-6">
                <div class="rank-card silver">
                    <div class="rank-badge">2</div>
                    <span class="user-name">ä½è—¤ æ¬¡éƒ</span>
                    <span class="score text-muted">28æš</span>
                </div>
            </div>
            <div class="col-6">
                <div class="rank-card bronze">
                    <div class="rank-badge">3</div>
                    <span class="user-name">éˆ´æœ¨ ä¸‰éƒ</span>
                    <span class="score text-muted">25æš</span>
                </div>
            </div>
        </div>

        <!-- 4ä½ä»¥ä¸‹ï¼ˆãƒªã‚¹ãƒˆå½¢å¼ï¼‰ -->
        <div class="rank-list-mini">
            <!-- {% for rank in rank_others %} -->
            <div class="rank-list-item">
                <span class="num">4</span>
                <span class="name">é«˜æ©‹ äº”éƒ</span>
                <span class="pts">22æš</span>
            </div>
            <div class="rank-list-item">
                <span class="num">5</span>
                <span class="name">æ¸¡è¾º ä¸ƒå­</span>
                <span class="pts">20æš</span>
            </div>
            <!-- {% endfor %} -->
        </div>
    </div>
</div>

<!-- 4. é€šçŸ¥ ï¼† ãƒã‚¤ãƒªã‚¹ãƒˆ -->
<div class="dashboard-wrapper">
    <a href="#" class="content-box mb-3">
        <h2>ğŸ”” å¾©ç¿’ãŒå¿…è¦ãªæ¤œå®š</h2>
        <div class="box-placeholder">
            <!-- å°†æ¥çš„ã«ã¯æœŸé™ãŒè¿‘ã„æ¤œå®šã‚’1ã¤è¡¨ç¤º -->
            ãƒ“ã‚¸ãƒã‚¹ãƒãƒŠãƒ¼åŸºç¤ï¼ˆæ®‹ã‚Š3æ—¥ï¼‰
        </div>
    </a>

    <a href="#" class="content-box">
        <h2>ğŸ“ ãŠæ°—ã«å…¥ã‚Šãƒªã‚¹ãƒˆ</h2>
        <div class="box-placeholder">
            <!-- {{ favorite_courses.count }}ä»¶ã®ä¿å­˜æ¸ˆã¿ã‚³ãƒ¼ã‚¹ãŒã‚ã‚Šã¾ã™ -->
            ä¿å­˜ã—ãŸå‹•ç”»ã‚„ãƒ†ã‚­ã‚¹ãƒˆã‚’ãƒã‚§ãƒƒã‚¯
        </div>
    </a>
</div>

<style>
/* --- ãƒ›ãƒ¼ãƒ ãƒšãƒ¼ã‚¸å°‚ç”¨ãƒ‡ã‚¶ã‚¤ãƒ³CSS --- */

/* ã‚¦ã‚§ãƒ«ã‚«ãƒ ã‚¨ãƒªã‚¢ */
.welcome-banner {
    background: white;
    padding: 20px;
    border-radius: 24px;
    border: 1px solid #f0f0f0;
}
.avatar-wrapper {
    width: 60px; height: 60px;
    background: var(--primary-color);
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 30px;
    box-shadow: 0 4px 15px rgba(118, 177, 157, 0.3);
}
.greeting-text { font-size: 1.1rem; font-weight: 800; margin: 0; }
.status-msg { font-size: 0.8rem; color: #777; margin: 0; }

/* çµ±è¨ˆãƒœãƒƒã‚¯ã‚¹ */
.stat-box {
    background: white; padding: 15px; border-radius: 20px;
    text-align: center; border: 1px solid #f0f0f0;
}
.stat-box.accent { background: #fffaf5; border-color: var(--accent-color); }
.stat-label { font-size: 0.7rem; color: #999; margin-bottom: 2px; }
.stat-value { font-size: 1.6rem; font-weight: 900; color: var(--primary-color); margin: 0; }
.stat-box.accent .stat-value { color: var(--accent-color); }

/* ãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ */
.ranking-section { background: #fdfdfd; }
.box-header { display: flex; justify-content: space-between; align-items: center; }
.update-time { font-size: 0.65rem; color: #bbb; }

.rank-card {
    background: white; border-radius: 16px; padding: 15px;
    position: relative; border: 1px solid #eee; margin-bottom: 10px;
    display: flex; align-items: center; gap: 15px;
    transition: var(--transition-base);
}
.rank-badge {
    width: 28px; height: 28px; border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-weight: 900; font-size: 0.9rem; background: #eee;
}

/* é †ä½åˆ¥ã‚«ãƒ©ãƒ¼ */
.gold { border: 2px solid #FFD700; background: #fffdf0; }
.gold .rank-badge { background: #FFD700; color: white; }
.silver { background: #f8f8f8; }
.silver .rank-badge { background: #C0C0C0; color: white; }
.bronze { background: #f8f8f8; }
.bronze .rank-badge { background: #CD7F32; color: white; }

.gold .user-name { font-size: 1.1rem; font-weight: 900; }
.rank-info { display: flex; flex-direction: column; }
.score { font-weight: 800; color: var(--accent-color); font-size: 0.9rem; }

/* 4ä½ä»¥ä¸‹ã®ãƒªã‚¹ãƒˆ */
.rank-list-mini {
    border-top: 1px dashed #ddd; padding-top: 10px;
}
.rank-list-item {
    display: flex; justify-content: space-between; padding: 6px 10px;
    font-size: 0.85rem; border-bottom: 1px solid #f9f9f9;
}
.rank-list-item .num { font-weight: bold; color: #aaa; margin-right: 10px; }
.rank-list-item .name { flex: 1; }
.rank-list-item .pts { font-weight: bold; }

</style>
{% endblock %}